{% extends "base.html" %}

{% block title %}Dashboard{% endblock %}

{% block content %}
    <div class="card card-dashboard">
        {% include '_flash_messages.html' %} 
        
        <h2>Welcome back, <b>{{ session['student_name'] }}</b>!</h2>
        
        <div class="stat-grid mt-4">
            <div class="stat-box status-{{ student.s_status.lower() }}">
                <p class="stat-label">Account Status</p>
                <p class="stat-value">{{ student.s_status }}</p>
                <small>Current Approval State</small>
            </div>
            
            <div class="stat-box">
                <p class="stat-label">Evaluations Done</p>
                <p class="stat-value">{{ evaluations_count }}</p>
                <small>Total forms submitted</small>
            </div>

            <div class="stat-box stat-progress">
                <p class="stat-label">Teachers Left</p> <p class="stat-value">{{ remaining_teachers }} / {{ total_teachers }}</p> <small>Progress towards completion</small>
            </div>
        </div>
        
        <div class="user-details mt-4">
            <h3>Your Details</h3>
            <p><strong>School ID:</strong> <span>{{ student.s_schoolID }}</span></p>
            <p><strong>Email:</strong> <span>{{ student.s_email }}</span></p>
            <p><strong>Year Level:</strong> <span>{{ student.s_year_level }}</span></p>
        </div>

        <h3 class="mt-5 mb-3">Update Profile</h3>
        <form method="POST" class="form-grid mt-4">
            <input type="hidden" name="action" value="edit_profile">
            <div class="form-group">
                <label for="s_first_name">First Name</label>
                <input type="text" id="s_first_name" name="s_first_name" value="{{ student.s_first_name }}" required>
            </div>
            <div class="form-group">
                <label for="s_last_name">Last Name</label>
                <input type="text" id="s_last_name" name="s_last_name" value="{{ student.s_last_name }}" required>
            </div>
            <div class="form-group">
                <label for="s_email">Email</label>
                <input type="email" id="s_email" name="s_email" value="{{ student.s_email }}" required>
            </div>
            <div class="form-group">
                <label for="s_year_level">Year Level</label>
                <select id="s_year_level" name="s_year_level" required>
                    <option value="1st Year" {% if student.s_year_level == '1st Year' %}selected{% endif %}>1st Year</option>
                    <option value="2nd Year" {% if student.s_year_level == '2nd Year' %}selected{% endif %}>2nd Year</option>
                    <option value="3rd Year" {% if student.s_year_level == '3rd Year' %}selected{% endif %}>3rd Year</option>
                    <option value="4th Year" {% if student.s_year_level == '4th Year' %}selected{% endif %}>4th Year</option>
                </select>
            </div>
            <div class="form-group">
                <label for="s_password">New Password</label>
                <input type="password" id="s_password" name="s_password" placeholder="Enter new password to change" required>
            </div>
            <div class="form-group">
                <label for="s_confirm_password">Confirm Password</label>
                <input type="password" id="s_confirm_password" name="s_confirm_password" placeholder="Confirm new password" required>
            </div>
            <button type="submit" class="btn btn-primary mt-3" style="grid-column: 1 / -1;">Save Profile Changes</button>
        </form>
        
    </div>
{% endblock %}